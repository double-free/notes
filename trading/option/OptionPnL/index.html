
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Ye">
      
      
      
        <link rel="prev" href="../Ito/">
      
      
        <link rel="next" href="../Risk/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.2">
    
    
      
        <title>Reading Note: Option Profit and Loss Attribution and Pricing - My Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7bf56d0a.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reading-note-option-profit-and-loss-attribution-and-pricing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="My Notes" class="md-header__button md-logo" aria-label="My Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reading Note: Option Profit and Loss Attribution and Pricing
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="My Notes" class="md-nav__button md-logo" aria-label="My Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    My Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Ye's Notes
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Computer science
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Computer science
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          Algorithm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Algorithm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/algorithm/swiss_map/" class="md-nav__link">
        Hash Table in Rust: SwissTable
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Lgbm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Lgbm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/lgbm/LgbmL1AndL2/" class="md-nav__link">
        LightGBM 参数中的 lambda_l1 和 lambda_l2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/lgbm/LgbmVol1/" class="md-nav__link">
        LightGBM 实战：波动率预测(1)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/lgbm/LgbmVol2/" class="md-nav__link">
        LightGBM 实战：波动率预测(2)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/lgbm/LightGBM/" class="md-nav__link">
        Light GBM 原理
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          Memory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Memory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/memory/CPU_Caches/" class="md-nav__link">
        Memory3: CPU Caches
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/memory/ParquetRepDef/" class="md-nav__link">
        Definition and Repetition Level in Parquet
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Mathematics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Mathematics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          CFR
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          CFR
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/CFR/CfrAndKuhnPoker/" class="md-nav__link">
        Counterfactual Regret Minimization and Kuhn Poker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/CFR/MonteCarloCfr/" class="md-nav__link">
        Monte Carlo CFR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/CFR/RegretMatchingAndBlottoGame/" class="md-nav__link">
        Regret Matching and Blotto Game
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          ESL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          ESL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/ESL/ESL10_BoostingMethods/" class="md-nav__link">
        ESL 10.1: Boosting Methods
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/ESL/ESL10_BoostingTrees/" class="md-nav__link">
        ESL 10.9: Boosting Trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/ESL/ESL11_NeuralNetworks/" class="md-nav__link">
        ESL 11: Neural Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/ESL/ESL12_SVM/" class="md-nav__link">
        ESL 12: Support Vector Machines and Flexibile Discriminants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/ESL/ESL3_LinearMethodsForRegression/" class="md-nav__link">
        ESL 3: Linear Methods for Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/ESL/ESL4_LinearMethodsForClassification/" class="md-nav__link">
        ESL 4: Linear Methods for Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/ESL/ESL6_KernelSmoothingMethods/" class="md-nav__link">
        ESL 6: Kernel Smoothing Methods
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/ESL/ESL9_AdditiveModels/" class="md-nav__link">
        ESL 9.1: Generalized Additive Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/ESL/ESL9_TreeBasedMethods/" class="md-nav__link">
        ESL 9.2: Tree-Based Methods
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Matrix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Matrix
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/matrix/MatrixCalculus/" class="md-nav__link">
        向量和矩阵求导
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Statistics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Statistics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/statistics/OLS_result/" class="md-nav__link">
        Interpret OLS Regression Result
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/statistics/RigidBalls/" class="md-nav__link">
        小球碰撞问题中的统计学
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/statistics/exercises/" class="md-nav__link">
        概率论经典题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mathematics/statistics/martingale/" class="md-nav__link">
        Martingale
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Trading
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Trading
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          Option
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Option
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../BSM/" class="md-nav__link">
        The Black-Scholes-Merton model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../BinomialTree/" class="md-nav__link">
        Binomial Trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Greeks/" class="md-nav__link">
        The Greek letters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Ito/" class="md-nav__link">
        Wiener processes and Ito’s lemma
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Reading Note: Option Profit and Loss Attribution and Pricing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Reading Note: Option Profit and Loss Attribution and Pricing
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    使用新方法进行期权定价
  </a>
  
    <nav class="md-nav" aria-label="使用新方法进行期权定价">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    期权自身风险暴露与价格的关系
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    通过历史数据确定系数
  </a>
  
    <nav class="md-nav" aria-label="通过历史数据确定系数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-at-the-money-implied-variance-term-structure" class="md-nav__link">
    The At-the-Money Implied Variance Term Structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-implied-volatility-smile" class="md-nav__link">
    The Implied Volatility Smile
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Risk/" class="md-nav__link">
        Option Volatility and Pricing - Risks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../VolatilitySmile/" class="md-nav__link">
        Volatility Smile
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Portfolio
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Portfolio
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../portfolio/CVaR/" class="md-nav__link">
        Portfolio Optimization with CVaR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../portfolio/MarkowitzPO/" class="md-nav__link">
        Portfolio Optimization with Known Parameters
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    使用新方法进行期权定价
  </a>
  
    <nav class="md-nav" aria-label="使用新方法进行期权定价">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    期权自身风险暴露与价格的关系
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    通过历史数据确定系数
  </a>
  
    <nav class="md-nav" aria-label="通过历史数据确定系数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-at-the-money-implied-variance-term-structure" class="md-nav__link">
    The At-the-Money Implied Variance Term Structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-implied-volatility-smile" class="md-nav__link">
    The Implied Volatility Smile
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="reading-note-option-profit-and-loss-attribution-and-pricing">Reading Note: Option Profit and Loss Attribution and Pricing</h1>
<p>一篇论文阅读笔记：</p>
<blockquote>
<p>"Option Profit and Loss Attribution and Pricing: A New Framework", by Peter Carr and Liuren Wu.</p>
</blockquote>
<p>个人认为，这篇文章专注期权定价和风险分析的 "locality"。这个 locality 体现在：</p>
<ol>
<li>不以期权的长期的 terminal payoff，而是以短期的 implied volatility 以及 underlying price 来定价。</li>
<li>不用 underlying 级别的统一 volatility，而是用期权自己的 implied volatility</li>
</ol>
<p>传统的方法专注于找到一个适用于所有 contracts 的 "<strong>中心化</strong>" 的参数(例如 BSM 中的 volatility)，而这篇文章的方法专注于一个 contract 自身的属性，是一种 “<strong>去中心化</strong>” 的方法。</p>
<p>原文中提到，这两种方法是相辅相成的：</p>
<blockquote>
<p>The two approaches do not directly compete, but rather complement each other. Dynamics specifications from the traditional approach can provide insights for formulating hypotheses on moment condition estimation, while empirically identified co-movement patterns in the moment conditions can provide guidance for the specification of reference dynamics.</p>
</blockquote>
<p>"moment" 是全文中多次提到的词，本文的语境下可认为是期权价格对于某一影响因素的导数。例如原文提到：</p>
<blockquote>
<p>This pricing equation is not based on the full specification of the underlying security price dynamics, but rather on the first and second conditional moments of the security price and the option’s implied volatility movements at time t.</p>
</blockquote>
<p>在这个新方法框架下，基于风险中性以及无套利假设，单个期权的价格是和它自身的风险对消的。比较多个期权的价格，必须先比较他们的风险暴露。新方法本质上是通过确定各个风险暴露的系数，再依据假设“持有的期权在 theta 上的损失等于其在其他 greeks 上的期望 PnL” 来决定价格。</p>
<h2 id="_1">使用新方法进行期权定价</h2>
<p>我们考虑一个 European call option，将其持有到到期日会有一个 terminal payoff，在传统方法中，我们会利用一些假设来简化并计算这个 <strong>payoff 的期望值</strong>，再利用这个期望值确定期权现在的价值。</p>
<p>在新的方法框架中，我们专注于 <strong>瞬时的 PnL</strong> 而非最终 payoff。期权的短期 PnL 取决于各个 greeks 上的风险暴露，新方法是通过量化其风险的大小来定价，而非通过 payoff。</p>
<p>期权的瞬时 PnL 的影响因素有：</p>
<ol>
<li>距离到期日的时间 (time to maturity)</li>
<li>标的物价格 (underlying price)</li>
<li>隐含波动率 (implied volatility)</li>
</ol>
<p>我们可以把 European call option 的价值近似表示为一个函数（<strong>假设利率为 0.0</strong>）：</p>
<div class="arithmatex">\[ B(t, S_t, I_t; K, T) \]</div>
<p>注意，这个函数并不是基于 BSM 公式推导，而仅仅是确定了影响期权价格的自变量。更进一步，我们利用全微分公式，把期权价格的变化率表示为：</p>
<div class="arithmatex">\[ \mathop{\mathrm{d} B} = [B_t \mathop{\mathrm{d} t} + B_S \mathop{\mathrm{d} S_t} + B_I \mathop{\mathrm{d} I_t}] + [\frac{1}{2} B_{SS} (\mathop{\mathrm{d} S_t})^2 + \frac{1}{2} B_{II} (\mathop{\mathrm{d} I_t})^2 + B_{IS} (\mathop{\mathrm{d} S_t} \mathop{\mathrm{d} I_t})] + J_t \]</div>
<p>其中，<span class="arithmatex">\(d_X\)</span> 表示变量 <span class="arithmatex">\(X\)</span> 极小的一个变化量。由于 underlying price 和 implied volatility 变动更加剧烈，是期权风险暴露的主要成分。因此，我们需要用二阶近似，而时间仅需要一阶近似。另外，<span class="arithmatex">\(J_t\)</span> 更高阶的扰动。各系数意义如下：</p>
<table>
<thead>
<tr>
<th align="center">Variable</th>
<th align="center">Name</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><span class="arithmatex">\(B\)</span></td>
<td align="center">Option Price</td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><span class="arithmatex">\(B_t\)</span></td>
<td align="center">Theta</td>
<td align="center">time decay of option price in BSM formula</td>
</tr>
<tr>
<td align="center"><span class="arithmatex">\(B_S\)</span></td>
<td align="center">Delta</td>
<td align="center"><code>Delta</code> is first order greek, it is the ratio of change in option price to the change in underlying price.</td>
</tr>
<tr>
<td align="center"><span class="arithmatex">\(B_{SS}\)</span></td>
<td align="center">Gamma</td>
<td align="center"><code>Gamma</code> is second order greek, it is the ratio of change in <code>Delta</code> to the change in underlying price.</td>
</tr>
<tr>
<td align="center"><span class="arithmatex">\(B_I\)</span></td>
<td align="center">Vega</td>
<td align="center"><code>Vega</code> is first order greek, it is the ratio of change in option price to the change in volatility</td>
</tr>
<tr>
<td align="center"><span class="arithmatex">\(B_{II}\)</span></td>
<td align="center">Volga</td>
<td align="center"><code>Volga</code> is second order greek, it is the ratio of change in <code>Vega</code> to the change in volatility.</td>
</tr>
<tr>
<td align="center"><span class="arithmatex">\(B_{IS}\)</span></td>
<td align="center">Vanna</td>
<td align="center"><code>Vanna</code> is second order greek, it is the ratio of change in <code>Vega</code> to the change in underlying price. Alternatively, it is the ratio of change in <code>Delta</code> to the change in volatility</td>
</tr>
</tbody>
</table>
<p>截止目前还是正常的 BSM 公式的应用，我们已经把瞬时的盈亏转化到各个风险维度上，下一步则是得到 PnL 的期望值。</p>
<h3 id="_2">期权自身风险暴露与价格的关系</h3>
<p>我们把刚才的公式用各变量 <strong>变化率</strong> 表示，并对两边求期望，再除以瞬时 investment horizon，得到：</p>
<div class="arithmatex">\[ \frac{E[\mathop{\mathrm{d} B}]}{\mathop{\mathrm{d}t}} = B_t + B_I I_t \mu_t + \frac{1}{2} B_{SS} S_t^2 \sigma_t^2 + \frac{1}{2}B_{II} I_t^2 w_t^2 + B_{IS} I_t S_t \gamma_t \]</div>
<p>其中：</p>
<div class="arithmatex">\[\begin{aligned}
\mu_t &amp;= E[\frac{\mathop{\mathrm{d} I_t}}{I_t}] / \mathop{\mathrm{d} t} \\
\sigma_t^2 &amp;= E[(\frac{\mathop{\mathrm{d} S_t}}{S_t})^2] / \mathop{\mathrm{d} t} \\
\omega_t^2 &amp;= E[(\frac{\mathop{\mathrm{d} I_t}}{I_t})^2] / \mathop{\mathrm{d} t} \\
\gamma_t &amp;= E[(\frac{\mathop{\mathrm{d} S_t}}{S_t} \cdot \frac{\mathop{\mathrm{d} I_t}}{I_t})] / \mathop{\mathrm{d} t} \\
\end{aligned}\]</div>
<p>注意到上式中有 implied volatility 的期望变化率，却没有 stock return 的期望变化率。这是因为本文作者做了如下假设：</p>
<div class="arithmatex">\[ E[\frac{\mathop{\mathrm{d} S_t}}{S_t}] = 0  \]</div>
<p>因为在 0 利率以及风险中性假设下，资产的 <strong>期望回报率为 0</strong>。同样由于这个假设，期权的投资回报率预期值也是 0，因此：</p>
<div class="arithmatex">\[ 0 = \frac{E[\mathop{\mathrm{d} B}]}{\mathop{\mathrm{d}t}} = B_t + B_I I_t \mu_t + \frac{1}{2} B_{SS} S_t^2 \sigma_t^2 + \frac{1}{2}B_{II} I_t^2 w_t^2 + B_{IS} I_t S_t \gamma_t \]</div>
<p>这个式子揭示了短期期权交易的 trade-offs：</p>
<blockquote>
<p>By being long in an option, one loses time value as calendar time passes (captured by <code>Theta</code>). The loss is compensated by:
  1) underlying return variance <span class="arithmatex">\(\sigma_t^2\)</span>, multiplied by <code>Gamma</code>,
  2) implied volatility variance <span class="arithmatex">\(\omega_t^2\)</span>, multiplied by <code>Volga</code>,
  3) covariance of underlying return and implied volatility <span class="arithmatex">\(\gamma_t\)</span>, multiplied by <code>Vanna</code>,
  4) implied volatility movement <span class="arithmatex">\(\mu_t\)</span>, multiplied by <code>Vega</code>.</p>
</blockquote>
<p>基于上述关系，我们判断一个 option 的价格是否合理就相当于判断这个 option 在 <code>Theta</code> 上的期望损失是否等于在 <code>Gamma</code>, <code>Vega</code>, <code>Volga</code>, <code>Vanna</code> exposures 上的期望盈利。</p>
<p>注意，如果我们假设 implied volatility 不变，则有:</p>
<div class="arithmatex">\[ \mu_t = \omega_t^2 = \gamma_t = 0 \]</div>
<p>上式退化为 BSM 模型的情形 (BSM 也假设了波动率为常数)：</p>
<div class="arithmatex">\[ B_t + \frac{1}{2} B_{SS} S_t^2 \sigma_t^2 = 0 \]</div>
<p>截止目前，我们并未用到 BSM 公式，也就是说上面的等式是对非 BSM 模型也成立的。接下来，我们探讨基于 BSM 模型假设下的各项系数关系。</p>
<p>假设 <span class="arithmatex">\(t\)</span> 是当前时间，<span class="arithmatex">\(\tau\)</span> 是距离期权到期的时间，由 BSM 公式，我们可以得到：</p>
<div class="arithmatex">\[ B_{SS} = \mathrm{Gamma} = \frac{\Phi'(d_1)}{S_t I_t \sqrt{\tau}} \]</div>
<p>其中 <span class="arithmatex">\(\Phi\)</span> 是标准正态分布的 cdf。因此 cash Gamma 为：</p>
<div class="arithmatex">\[ B_{SS} S_t^2 = \frac{S_t \Phi'(d_1)}{I_t \sqrt{\tau}} \]</div>
<p>同理得到 cash Theta 和 cash Vega，并以 cash Gamma 表示：</p>
<div class="arithmatex">\[ B_t = \mathrm{Theta} = -\frac{1}{2} S_t I_t \Phi'(d_1) / \sqrt{\tau} = -\frac{1}{2} I_t^2 \cdot B_{SS} S_t^2 \]</div>
<div class="arithmatex">\[ B_{I} I_t = S_t \sqrt{\tau} \Phi'(d_1) \cdot I_t = I_t^2 \tau \cdot B_{SS} S_t^2 \]</div>
<p>cash Volga:</p>
<div class="arithmatex">\[\begin{aligned}
B_{II} I_t^2 &amp;= \frac{\partial B_I}{\partial I_t} \cdot I_t^2 \\
             &amp;= S_t \sqrt{\tau} \Phi''(d_1) \frac{\partial d_1}{\partial I_t} \cdot I_t^2 \\
             &amp;= S_t \sqrt{\tau} \Phi'(d_1) d_1 [ \frac{\ln{S/K}}{I_t^2 \sqrt{\tau}} - \frac{1}{2} \sqrt{\tau}] \cdot I_t^2 \\
             &amp;= S_t \sqrt{\tau} \Phi'(d_1) d_1 d_2 \frac{1}{I_t} \cdot I_t^2 \\
             &amp;= d_1 d_2 I_t^2 \tau \cdot B_{SS} S_t^2
\end{aligned}\]</div>
<p>cash Vanna:</p>
<div class="arithmatex">\[\begin{aligned}
B_{IS} I_tS_t &amp;= \frac{\partial B_I}{\partial S_t} \cdot I_tS_t \\
             &amp;= \sqrt{\tau} [\Phi'(d_1) + S_t \Phi''(d_1) \frac{\partial d_1}{\partial S_t}] \cdot I_t S_t \\
             &amp;= \sqrt{\tau} \Phi'(d_1) (1 - \frac{d_1}{I_t \sqrt{\tau}}) \cdot I_t S_t \\
             &amp;= -\Phi'(d_1) \frac{d_2}{I_t}  \cdot I_t S_t \\
             &amp;= - d_2 I_t \sqrt{\tau}  \cdot B_{SS} S_t^2
\end{aligned}\]</div>
<p>将以上 cash greeks 代入公式，消去 cash Gamma，得到：</p>
<div class="arithmatex">\[ I_t^2 = 2\mu_t I_t^2 \tau + \sigma_t^2 + \omega_t^2 d_1 d_2 I_t^2 \tau - 2 \gamma_t d_2 I_t \sqrt{\tau} \]</div>
<p>传统的期权定价把 <strong>cross-sectional consistency 作为其首要目的</strong>，为了达到这个目的，使用者需要建模标的资产的价格变动，基于这个统一的假设模型，算出期权 terminal payoff 的期望，再折现进行定价。由于使用了统一的标的资产价格模型，所有的期权定价拥有了一致性。</p>
<p>然而，上式则是一个更加局部的方法，它描述了 <strong>期权自身风险和回报的 trade-off</strong>。我们可以将期权的价值与它 underlying price 和 implied volatility 上的一阶、二阶 greeks 上的风险做比较。</p>
<h3 id="_3">通过历史数据确定系数</h3>
<p>我们可以通过历史数据拟合获得 <span class="arithmatex">\(\mu_t\)</span>, <span class="arithmatex">\(omega_t^2\)</span>, <span class="arithmatex">\(\gamma_t\)</span>。而 <span class="arithmatex">\(\sigma_t^2\)</span> 可以直接通过 underlying price 获取。</p>
<p>本章一共利用了 3 个假设，分别是：</p>
<ol>
<li>expiry 接近的 at-the-money option <span class="arithmatex">\(\mu_t\)</span> 相同</li>
<li>同一 expiry，在一定范围内不同 strikes 的 <span class="arithmatex">\(\mu_t I_t^2\)</span> 相同</li>
<li>同一 expiry，在一定范围内不同 strikes 的 <span class="arithmatex">\(\omega_t^2\)</span> 和 <span class="arithmatex">\(\gamma_t\)</span> 相同</li>
</ol>
<p>这三个假设可靠性后面会用实际数据验证。直观上与我们调节 volatility curve 的思路是类似的。</p>
<h4 id="the-at-the-money-implied-variance-term-structure">The At-the-Money Implied Variance Term Structure</h4>
<p>为了将 term structure 和 moneyness effect 分开分析，我们定义 at-the-money 期权满足以下条件：</p>
<div class="arithmatex">\[ d_2 = \frac{\ln(S_t/K) + \frac{1}{2} I_t^2 \tau}{I_t \sqrt{\tau}} = 0 \]</div>
<p>在上述条件下，期权的 <code>Volga</code> <code>Vanna</code> 都为 0，此外，由于 <span class="arithmatex">\(d_2 = 0\)</span> 等式可以简化为：</p>
<div class="arithmatex">\[ I_t^2 = 2\mu_t I_t^2 \tau + \sigma_t^2 \]</div>
<blockquote>
<p>注意，这里的 at-the-money 期权的定义并不是传统的 <code>Delta = 0.5</code> 的期权，<code>Delta = 0.5</code> 的期权是满足 <span class="arithmatex">\(d_1 = 0\)</span> 的，而这里是 <span class="arithmatex">\(d_2 = 0\)</span> 的。其中，<span class="arithmatex">\(\Phi(d_2)\)</span> 的现实意义是在到期时变为 in-the-money 的概率。</p>
</blockquote>
<p>这里给我们的启示是，在学习中不要教条主义，moneyness 的定义完全是交易者根据自己分析需要定义的，at-the-money 的期权可以是 <code>S = K</code>（这样的期权没有intrinsic value，只有time value），可以是 <code>d1 = 0</code>（此时 <code>Delta = 0.5</code>），也可以是 <code>d2 = 0</code>（本文的定义，此时 Volga 和 Vanna 都为 0）。</p>
<p>我们进一步 <strong>假设</strong> 两个到期日接近的 atm 期权的 implied volatility 变化率相近，即：</p>
<div class="arithmatex">\[ \mu_t(\tau_1) \approx \mu_t(\tau_2) \]</div>
<p>则我们可以通过以下方式算出 <span class="arithmatex">\(\mu_t\)</span>：</p>
<div class="arithmatex">\[ \mu_t = \frac{A_t^2(\tau_2) - A_t^2(\tau_1)}{2(A_t^2(\tau_2) \tau_2 - A_t^2(\tau_1) \tau_1)} \]</div>
<p>其中 <span class="arithmatex">\(A_t(\tau)\)</span> 表示 <span class="arithmatex">\(\tau\)</span> 时间过后到期的 atm 期权的 implied volatility。</p>
<h4 id="the-implied-volatility-smile">The Implied Volatility Smile</h4>
<p>接下来，我们分析同一个 expiry 下，其他期权与 atm 期权的 implied volatility 关系。</p>
<p>我们把 <span class="arithmatex">\(A_t(\tau)\)</span> 作为已经计算出来的数值，然后用它来表示同一个 expiry 下其他期权的 implied volatility。可以得到：</p>
<div class="arithmatex">\[ I_t^2 - A_t^2 = 2 \tau (\mu_t I_t^2 - \mu_t^A A_t^2) + \omega_t^2 d_1 d_2 I_t^2 \tau - 2 \gamma_t d_2 I_t \sqrt{\tau} \]</div>
<p>如果我们更进一步 <strong>假设</strong> implied volatility 变化率与其平方成反比，即:</p>
<div class="arithmatex">\[ \mu_t I_t^2 = \mu_t^A A_t^2 \]</div>
<blockquote>
<p>TOOD: is this a valid assumption?</p>
</blockquote>
<p>则可以简化为：</p>
<div class="arithmatex">\[ I_t^2 - A_t^2 = \omega_t^2 d_1 d_2 I_t^2 \tau - 2 \gamma_t d_2 I_t \sqrt{\tau} \]</div>
<p>即，对于每个 strike，它的 implied volatility 和 atm 期权的平方差可以由 implied volatility variance 和 volatility-return covariance 确定。因此，<strong>波动率微笑曲线的形状是由它下一个时间片波动率可能的变化，以及波动率对 underlying price 变化的响应决定的</strong>。</p>
<p>由于 implied volatility 和 d1, d2 可以直接结算得到，我们通过历史数据可以拟合出 <span class="arithmatex">\(\gamma_t\)</span> 和 <span class="arithmatex">\(\omega_t^2\)</span> 的值。</p>
<p>为了统一不同的 strikes，我们再次假设同一 expiry 下，在 at-the-money 附近范围内的 implied volatility 变化特性相同，即：</p>
<div class="arithmatex">\[ \omega_t^2(k) = \omega_t^2, \gamma_t(k) = \gamma_t \]</div>
<p>由于 near-the-money 期权交易最活跃，我们可以用 atm 期权以及它附近的（即 <span class="arithmatex">\(-\epsilon &lt; d_2 &lt; \epsilon\)</span>）的期权来计算 <span class="arithmatex">\(\omega_t^2\)</span> 和 <span class="arithmatex">\(\gamma_t\)</span>。</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fc8c2696.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>