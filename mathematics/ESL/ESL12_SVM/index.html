
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Ye">
      
      
      
        <link rel="prev" href="../ESL11_NeuralNetworks/">
      
      
        <link rel="next" href="../ESL3_LinearMethodsForRegression/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.2">
    
    
      
        <title>ESL 12: Support Vector Machines and Flexibile Discriminants - My Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7bf56d0a.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#esl-12-support-vector-machines-and-flexibile-discriminants" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="My Notes" class="md-header__button md-logo" aria-label="My Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ESL 12: Support Vector Machines and Flexibile Discriminants
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="My Notes" class="md-nav__button md-logo" aria-label="My Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    My Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Ye's Notes
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Computer science
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Computer science
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          Algorithm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Algorithm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/algorithm/swiss_map/" class="md-nav__link">
        Hash Table in Rust: SwissTable
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Lgbm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Lgbm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/lgbm/LgbmL1AndL2/" class="md-nav__link">
        LightGBM 参数中的 lambda_l1 和 lambda_l2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/lgbm/LgbmVol1/" class="md-nav__link">
        LightGBM 实战：波动率预测(1)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/lgbm/LgbmVol2/" class="md-nav__link">
        LightGBM 实战：波动率预测(2)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/lgbm/LightGBM/" class="md-nav__link">
        Light GBM 原理
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          Memory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Memory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../computer-science/memory/CPU_Caches/" class="md-nav__link">
        Memory3: CPU Caches
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Mathematics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Mathematics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          CFR
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          CFR
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CFR/CfrAndKuhnPoker/" class="md-nav__link">
        Counterfactual Regret Minimization and Kuhn Poker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CFR/MonteCarloCfr/" class="md-nav__link">
        Monte Carlo CFR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CFR/RegretMatchingAndBlottoGame/" class="md-nav__link">
        Regret Matching and Blotto Game
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          ESL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          ESL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ESL10_BoostingMethods/" class="md-nav__link">
        ESL 10.1: Boosting Methods
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ESL10_BoostingTrees/" class="md-nav__link">
        ESL 10.9: Boosting Trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ESL11_NeuralNetworks/" class="md-nav__link">
        ESL 11: Neural Networks
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ESL 12: Support Vector Machines and Flexibile Discriminants
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        ESL 12: Support Vector Machines and Flexibile Discriminants
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#121-introduction" class="md-nav__link">
    12.1 Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#122-the-support-vector-classifier" class="md-nav__link">
    12.2 The Support Vector Classifier
  </a>
  
    <nav class="md-nav" aria-label="12.2 The Support Vector Classifier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    线性分类问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    非线性分类问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1221-computing-the-support-vector-classifier" class="md-nav__link">
    12.2.1 Computing the Support Vector Classifier
  </a>
  
    <nav class="md-nav" aria-label="12.2.1 Computing the Support Vector Classifier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kkt" class="md-nav__link">
    KKT 条件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#123-support-vector-machine-and-kernels" class="md-nav__link">
    12.3 Support Vector Machine and Kernels
  </a>
  
    <nav class="md-nav" aria-label="12.3 Support Vector Machine and Kernels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1231-computing-the-svm-for-classification" class="md-nav__link">
    12.3.1 Computing the SVM for Classification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ESL3_LinearMethodsForRegression/" class="md-nav__link">
        ESL 3: Linear Methods for Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ESL4_LinearMethodsForClassification/" class="md-nav__link">
        ESL 4: Linear Methods for Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ESL6_KernelSmoothingMethods/" class="md-nav__link">
        ESL 6: Kernel Smoothing Methods
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ESL9_AdditiveModels/" class="md-nav__link">
        ESL 9.1: Generalized Additive Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ESL9_TreeBasedMethods/" class="md-nav__link">
        ESL 9.2: Tree-Based Methods
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Matrix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Matrix
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../matrix/MatrixCalculus/" class="md-nav__link">
        向量和矩阵求导
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Probability
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Probability
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../probability/RigidBalls/" class="md-nav__link">
        小球碰撞问题中的统计学
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../probability/exercises/" class="md-nav__link">
        概率论经典题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../probability/martingale/" class="md-nav__link">
        Martingale
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Trading
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Trading
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          Option
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Option
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trading/option/BSM/" class="md-nav__link">
        The Black-Scholes-Merton model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trading/option/BinomialTree/" class="md-nav__link">
        Binomial Trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trading/option/Greeks/" class="md-nav__link">
        The Greek letters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trading/option/Ito/" class="md-nav__link">
        Wiener processes and Ito’s lemma
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trading/option/Risk/" class="md-nav__link">
        Option Volatility and Pricing - Risks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trading/option/VolatilitySmile/" class="md-nav__link">
        Volatility Smile
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Portfolio
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Portfolio
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trading/portfolio/CVaR/" class="md-nav__link">
        Portfolio Optimization with CVaR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trading/portfolio/MarkowitzPO/" class="md-nav__link">
        Portfolio Optimization with Known Parameters
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#121-introduction" class="md-nav__link">
    12.1 Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#122-the-support-vector-classifier" class="md-nav__link">
    12.2 The Support Vector Classifier
  </a>
  
    <nav class="md-nav" aria-label="12.2 The Support Vector Classifier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    线性分类问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    非线性分类问题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1221-computing-the-support-vector-classifier" class="md-nav__link">
    12.2.1 Computing the Support Vector Classifier
  </a>
  
    <nav class="md-nav" aria-label="12.2.1 Computing the Support Vector Classifier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kkt" class="md-nav__link">
    KKT 条件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#123-support-vector-machine-and-kernels" class="md-nav__link">
    12.3 Support Vector Machine and Kernels
  </a>
  
    <nav class="md-nav" aria-label="12.3 Support Vector Machine and Kernels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1231-computing-the-svm-for-classification" class="md-nav__link">
    12.3.1 Computing the SVM for Classification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="esl-12-support-vector-machines-and-flexibile-discriminants">ESL 12: Support Vector Machines and Flexibile Discriminants</h1>
<h2 id="121-introduction">12.1 Introduction</h2>
<p>当两个类 <strong>线性可分</strong> 时，我们可以用 Linear Discriminant Analysis 找到它们的最优分界面。当它们不是线性可分，相互重叠时，我们可以在 <strong>更高维的特征空间</strong> 中构造 <strong>线性</strong> 分界面。这种方法叫做支持向量机（support vector machine）。它是 LDA 的一个扩展。</p>
<p>相对于 LDA，它的主要优势是：</p>
<ul>
<li>可以处理非线性场景</li>
<li>分界面主要由边界上的样本点确定（LDA 需要各类样本中心点）</li>
</ul>
<h2 id="122-the-support-vector-classifier">12.2 The Support Vector Classifier</h2>
<p>在第四章中我们讨论了 <strong>线性可分</strong> 类型的最优分界面，这里，我们需要将其扩展至 <strong>线性不可分</strong> 的情形。</p>
<p>假设我们有 N 个训练数据：<span class="arithmatex">\((x_1, y_1), (x_2, y_2), \dots, (x_N, y_N)\)</span>，其中，<span class="arithmatex">\(x_i\)</span> 是 <span class="arithmatex">\(p\)</span> 维输入， <span class="arithmatex">\(y_i \in {-1, 1}\)</span> 是类型输出。</p>
<p>定义超平面（自变量 <span class="arithmatex">\(x\)</span>）</p>
<div class="arithmatex">\[ {x: f(x) = x^T \beta + \beta_0 = 0}, \]</div>
<p>上式的左边定义了某个点 <span class="arithmatex">\(x\)</span> 与该平面的距离（有符号）。其中，系数 <span class="arithmatex">\(\beta\)</span> 是 <strong>单位向量</strong> <span class="arithmatex">\(\| {\beta} \| = 1\)</span>。分类标准为：</p>
<div class="arithmatex">\[ G(x) = \text{sign}[x^T \beta + \beta_0]\]</div>
<p>我们的目的是找到在两个类型的数据中 margin 最大的分界面。</p>
<p><img alt="svm" src="../images/12/svm.png" /></p>
<h4 id="_1">线性分类问题</h4>
<p>对于线性分类问题，margin 可以定义为分界面距离最近的样本点的距离。即：</p>
<div class="arithmatex">\[\begin{align}
&amp; &amp; \mathop{\arg \max}_{\beta, \beta_0, \| \beta \| = 1} ~ M \\
&amp; \text{s.t.} &amp; y_i(x_i^T \beta + \beta_0) \geq M, ~~~ i=1,\dots,N
\end{align}\]</div>
<p>其中，<span class="arithmatex">\(x^T \beta + \beta_0 = 0\)</span> 是分界面，对于每个样本，预测值 <span class="arithmatex">\(x_i^T \beta + \beta_0\)</span> 可能为正或者负，目标是找到一组参数 <span class="arithmatex">\(\beta, \beta_0\)</span>，使得 margin 最大。</p>
<p>该优化问题并不是一个凸优化问题，比较难以求解。</p>
<p>首先，我们不再要求 <span class="arithmatex">\(\beta\)</span> 是单位向量，而是手动在约束里将其单位化，即：</p>
<div class="arithmatex">\[\begin{align}
&amp; &amp; \mathop{\arg \max}_{\beta, \beta_0} ~ M \\
&amp; \text{s.t.} &amp; y_i(x_i^T \beta + \beta_0) \geq M \| \beta \| , ~~~ i=1,\dots,N
\end{align}\]</div>
<p>令：</p>
<div class="arithmatex">\[\theta = \frac{\beta}{M\| \beta \|}\]</div>
<div class="arithmatex">\[\theta_0 = \frac{\beta_0}{M\| \beta \|}\]</div>
<p>约束条件可以改写为：</p>
<div class="arithmatex">\[ y_i(x_i^T \theta + \theta_0) \geq 1 \]</div>
<p>这个变换表示，对于该优化问题，对应不同的 M 取值，我们可以得到很多组解。等式右边的 1 表示对于参数 <span class="arithmatex">\(\theta\)</span> 的 <span class="arithmatex">\(M_\theta\)</span> 满足：</p>
<div class="arithmatex">\[ M_\theta \| \theta \| = 1 \]</div>
<p>显然，此时求 <span class="arithmatex">\(M_\theta\)</span> 的最大值就是求 <span class="arithmatex">\(\| \theta \|\)</span> 的最小值。因此，优化问题简化为：</p>
<div class="arithmatex">\[\begin{align}
&amp; &amp; \mathop{\arg \min}_{\theta, \theta_0} ~ \| \theta \| \\
&amp; \text{s.t.} &amp; y_i(x_i^T \theta + \theta_0) \geq 1, ~~~ i=1,\dots,N
\end{align}\]</div>
<p>这是一个凸优化问题，通常 SVM 用这个形式描述。</p>
<h4 id="_2">非线性分类问题</h4>
<p>现实中，可能不同的类别在特征空间中有重叠。因此，它们不能用一个线性分界面分割。对于这类情况，我们 <strong>对每个样本引入松弛变量</strong> <span class="arithmatex">\(\xi\)</span> 。并将约束条件放松为：</p>
<div class="arithmatex">\[ y_i (x_i^T \beta + \beta_0 ) \geq M(1 - \xi_i) \]</div>
<p><span class="arithmatex">\(\xi_i\)</span> 表示样本 i “越界”了多少（normalized by margin）。 这里的越界指的并非分界面，而是附加 margin 后形成的界限。<span class="arithmatex">\(\xi_i &gt; 1\)</span> 说明训练出的分界面对样本 i 进行了错误的分类。</p>
<p>我们可以通过限制 <span class="arithmatex">\(\sum \xi_i \leq C\)</span> 来限制我们松弛的程度。相对于线性分类的优化问题，非线性分类需要额外引入松弛变量，并增加一个约束条件：</p>
<div class="arithmatex">\[\begin{align}
&amp; &amp; \mathop{\arg \min}_{\theta, \theta_0} ~ \| \theta \| &amp;\\
&amp; \text{s.t.} &amp; ~ y_i(x_i^T \theta + \theta_0) \geq 1 - \xi_i, &amp; \\
&amp; &amp; \xi_i \geq 0, \sum_{i=1}^N \xi_i \leq C &amp; ~~~~ (i=1,\dots,N)
\end{align}\]</div>
<h3 id="1221-computing-the-support-vector-classifier">12.2.1 Computing the Support Vector Classifier</h3>
<p>我们可以把该优化问题转化成一个二次函数的凸优化问题：</p>
<div class="arithmatex">\[\begin{align}
&amp; &amp; \mathop{\arg \min}_{\theta, \theta_0} ~ \frac{1}{2} \| \theta \|^2 + C \sum_{i=1}^N \xi_i &amp; \\
&amp; \text{s.t.} &amp; ~ y_i(x_i^T \theta + \theta_0) \geq 1 - \xi_i, &amp; \\
&amp; &amp; \xi_i \geq 0 &amp; ~~~~ (i=1,\dots,N)
\end{align}\]</div>
<p>注意，在这里我们做了两个等效变换：</p>
<ol>
<li>将 <span class="arithmatex">\(\| \theta \|\)</span> 变成了 <span class="arithmatex">\(\frac{1}{2} \| \theta \|^2\)</span>.</li>
<li>将约束条件 <span class="arithmatex">\(\sum_{i=1}^N \xi_i \leq C\)</span> 转为一个惩罚项 <span class="arithmatex">\(C \sum_{i=1}^N\)</span>.</li>
</ol>
<p>引入拉格朗日乘子 <span class="arithmatex">\(\alpha_i, \mu_i\)</span> 有：</p>
<div class="arithmatex">\[ L_p = \frac{1}{2} \| \theta \|^2 + C \sum_{i=1}^N \xi_i -
   \sum_{i=1}^N \alpha_i[y_i(x_i^T \theta + \theta_0) - (1 - \xi_i)] - \sum_{i=1}^N(\mu_i \xi_i) \]</div>
<p>我们将其转化为对偶问题，需要满足 KKT 条件。</p>
<p><strong>条件一：平稳性条件</strong>。分别对参数 <span class="arithmatex">\(\theta, \theta_0, \xi_i\)</span> 求导并令导数为 0，得到：</p>
<div class="arithmatex">\[\begin{align}
\mathbf{\theta} &amp;= \sum_{i=1}^N \alpha_i y_i \mathbf{x_i} \\
0 &amp;= \sum_{i=1}^N \alpha_i y_i \\
\alpha_i &amp;= C - \mu_i
\end{align}\]</div>
<p>将上式代入 <span class="arithmatex">\(L_p\)</span> 得到其对偶问题：</p>
<div class="arithmatex">\[\begin{align}
L_D &amp;= \frac{1}{2} \| \theta \|^2 + \sum_{i=1}^N \alpha_i - \sum_{i=1}^N \alpha_i y_i(x_i^T \theta + \theta_0) \\
&amp;= \frac{1}{2} \| \theta \|^2 + \sum_{i=1}^N \alpha_i - \sum_{i=1}^N \theta^T \theta - \theta_0 \sum_{i=1}^N \alpha_i y_i  \\
&amp;= \sum_{i=1}^N \alpha_i - \frac{1}{2} \sum_{i=1}^N \theta^T \theta \\
&amp;= \sum_{i=1}^N \alpha_i - \frac{1}{2} \sum_{i=1}^N \sum_{j=1}^N \alpha_i
\alpha_j y_i y_j x_i^T x_j
\end{align}\]</div>
<p>由于是对偶问题，我们需要 <strong>最大化</strong> <span class="arithmatex">\(L_D\)</span>。此时，<span class="arithmatex">\(L_D\)</span> 中只包含未知参数 <span class="arithmatex">\(\alpha_i\)</span>。这个优化问题可以用 <strong>顺序最小化算法</strong>(Sequential Minimal Optimization)求解，这里不表。</p>
<p>我们可以假设已经得到一组最优的 <span class="arithmatex">\(\hat{\alpha}_i\)</span>。代入下式可以求得 <span class="arithmatex">\(\theta\)</span>：</p>
<div class="arithmatex">\[ \mathbf{\theta} = \sum_{i=1}^N \alpha_i y_i \mathbf{x_i} \]</div>
<p>对于参数 <span class="arithmatex">\(\theta_0\)</span>，我们还需要其他的 KKT 条件约束求解。</p>
<p><strong>条件二：原问题可行性</strong>。</p>
<div class="arithmatex">\[\begin{align}
y_i(x_i^T \theta + \theta_0) &amp;\geq (1 - \xi_i) \\
\xi_i &amp;\geq 0
\end{align}\]</div>
<p><strong>条件三：对偶问题可行性</strong>。</p>
<div class="arithmatex">\[\begin{align}
\alpha_i &amp; \geq 0 \\
\mu_i &amp; \geq 0
\end{align}\]</div>
<p><strong>条件四：互补松弛</strong>。</p>
<div class="arithmatex">\[\begin{align}
\alpha_i[y_i(x_i^T \theta + \theta_0) - (1 - \xi_i)] &amp;= 0 \\
\mu_i \xi_i &amp;= 0
\end{align}\]</div>
<p>通过平稳性条件，我们已经得到关系：</p>
<div class="arithmatex">\[ \hat{\theta} = \sum_{i=1}^N \hat{\alpha_i} y_i x_i \]</div>
<p>另，根据互补松弛条件，系数 <span class="arithmatex">\(\hat{\alpha_i}\)</span> 仅在约束 <span class="arithmatex">\(y_i(x_i^T \theta + \theta_0) \geq (1 - \xi_i)\)</span> <strong>等号成立</strong> 时取非 0，即：</p>
<div class="arithmatex">\[ y_i(x_i^T \theta + \theta_0) = (1 - \xi_i) \]</div>
<p>这些使等号成立的样本点被称为“<strong>支持向量</strong>” (support vectors)，因为系数 <span class="arithmatex">\(\hat{\theta}\)</span> 的取值只跟他们有关。</p>
<p>根据约束：</p>
<div class="arithmatex">\[ \alpha_i[y_i(x_i^T \theta + \theta_0) - (1 - \xi_i)] = 0 \]</div>
<p>支持向量中的任何一个样本都可以用于求解 <span class="arithmatex">\(\theta_0\)</span>，为了数值稳定性，我们使用所有解的 <strong>平均值</strong>。</p>
<p>我们再看以下两个约束条件，额外定性分析一下这些支持向量：</p>
<div class="arithmatex">\[\begin{align}
\alpha_i &amp;= C - \mu_i \\
\mu_i \xi_i &amp;= 0
\end{align}\]</div>
<p>在这些样本点中：</p>
<ul>
<li>
<p>如果 <span class="arithmatex">\(\xi_i = 0\)</span>，即样本 <span class="arithmatex">\(x_i\)</span> 在 margin 的边界上。此时 <span class="arithmatex">\(\mu_i &gt; 0\)</span> 且 <span class="arithmatex">\(0 \leq \alpha_i \leq C\)</span>。</p>
</li>
<li>
<p>如果 <span class="arithmatex">\(\xi_i &gt; 0\)</span>，即样本 <span class="arithmatex">\(x_i\)</span> 越过了 margin 边界，包括被错误分类的样本。此时 <span class="arithmatex">\(\mu_i = 0\)</span> 且 <span class="arithmatex">\(\alpha_i = C\)</span>。</p>
</li>
</ul>
<h4 id="kkt">KKT 条件</h4>
<p>KKT 方法是对拉格朗日乘子法的一个扩展。拉格朗日乘子法只能应用在等式约束上，而 <strong>KKT允许不等式约束</strong>。</p>
<p>对于优化问题：</p>
<div class="arithmatex">\[\begin{align}
&amp;\text{optimize} &amp; f(x) &amp; \\
&amp;\text{subject to:} &amp; g_i(x) \leq 0 &amp; (i = 1, \dots, m)\\
&amp;                  &amp; h_j(x) = 0 &amp; (j = 1, \dots, n)
\end{align}\]</div>
<p>其中 <span class="arithmatex">\(f(x)\)</span> 是目标函数，<span class="arithmatex">\(g_i(x)\)</span> 是不等式约束，<span class="arithmatex">\(h_j(x)\)</span> 是等式约束。对应拉格朗日函数：</p>
<div class="arithmatex">\[L(x, \alpha, \beta) = f(x) + \sum_{i=1}^m \alpha_i g_i(x) + \sum_{j=1}^n \beta_j h_j(x)\]</div>
<p>假设存在局部最优解 <span class="arithmatex">\(x^*\)</span>，则它应该满足以下 4 组约束（即可以用以下约束求解）：</p>
<ol>
<li>
<p>拉格朗日平稳性条件(Stationarity)</p>
<p>这是拉格朗日函数取极值时的必要条件，该点导数为0:</p>
<div class="arithmatex">\[ \frac{ \partial L(x, \alpha, \beta) }{\partial x} |_{x=x^*} = 0 \]</div>
</li>
<li>
<p>原问题可行条件(Primal feasibility)</p>
<p>需要满足原问题的可行性：</p>
<div class="arithmatex">\[\begin{align}
  g_i(x^*) \leq 0  \\
  h_j(x^*) = 0
\end{align}\]</div>
</li>
<li>
<p>对偶问题可行条件(Dual feasibility)</p>
<p>对于不等式约束，为了使 <span class="arithmatex">\(g_i(x)\)</span><strong>梯度方向总是指向可行域内部</strong>，需要满足系数非负：</p>
<div class="arithmatex">\[ \alpha_i \geq 0 \]</div>
</li>
<li>
<p>互补松弛条件(Complementary slackness)</p>
<p>最优解无非有两种情况，一种在不等式约束条件内部，即 <span class="arithmatex">\(g_i(x^*) &lt; 0\)</span>，此时约束条件不起作用，可以将对应的松弛变量设为 <span class="arithmatex">\(\alpha_i = 0\)</span>。另一种是在边界上，即 <span class="arithmatex">\(g_i(x^*) = 0\)</span>，此时约束条件有效。无论是以上哪种情况，都有：</p>
<div class="arithmatex">\[ \alpha_i g_i(x^*) = 0 \]</div>
</li>
</ol>
<h2 id="123-support-vector-machine-and-kernels">12.3 Support Vector Machine and Kernels</h2>
<p>上文讲述了支持向量分类器如何在 <strong>输入特征空间</strong> 寻找 <strong>线性</strong> 分界面。就像其他线性方法一样，我们可以通过引入基扩展（basis expansions）来扩展特征空间让分界面更灵活。</p>
<p>事实上，SVM 本质上是用一种特定的正则化形式来解决 <strong>函数拟合</strong> 问题。</p>
<h3 id="1231-computing-the-svm-for-classification">12.3.1 Computing the SVM for Classification</h3>
<p>在 12.2 中我们已经推导出 SVM 对偶问题的优化目标，最大化 <span class="arithmatex">\(L_D\)</span>：</p>
<div class="arithmatex">\[\begin{align}
L_D = \sum_{i=1}^N \alpha_i - \frac{1}{2} \sum_{i=1}^N \sum_{j=1}^N \alpha_i
\alpha_j y_i y_j x_i^T x_j
\end{align}\]</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fc8c2696.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>